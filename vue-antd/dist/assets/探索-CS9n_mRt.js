import{d as O,u as Z,r as m,c as ee,p as te,j as D,w as d,i as b,o as r,k as _,b as a,t as x,m as h,a as u,l as L,F as z,n as R,f as oe,e as q,g as ae,_ as le}from"./index-D4u6JD5c.js";const se={class:"top-info-container"},ne={class:"location-info"},re={class:"location-name"},ie={class:"location-coords"},ce={class:"map-controls"},ue={class:"map-section-container"},de={class:"map-container"},pe={class:"map-grid"},ve=["onClick"],fe={key:0,class:"player-marker"},ye={key:1,class:"cell-icon"},me={key:2,class:"cell-icon"},_e={key:3,class:"cell-icon"},xe={class:"map-nav-buttons"},ge={class:"nav-row"},ke={class:"nav-row"},we={class:"location-details-container"},be={class:"details-content"},he={key:0,class:"detail-row"},Ce={class:"detail-value"},Le={key:1,class:"detail-row"},ze={class:"detail-value"},$e={class:"detail-row"},Me={class:"spirit-qi-summary"},Se=["title"],Ve={class:"action-panel-container"},Pe={class:"action-buttons-grid"},Te={class:"legend-content"},Ne={class:"legend-text"},Be={class:"legend-icon"},E=150,De=O({__name:"æŽ¢ç´¢",setup(Re){const c=Z(),F=ae(),S=m(!1),C=m(null),i=m({x:c.player?.currentLocation?.x??10,y:c.player?.currentLocation?.y??10}),g=m([]),w=m(!1),f=ee(()=>c.getCurrentLocation),Q=()=>{const e=[];for(let t=0;t<100;t++){const o=[];for(let l=0;l<100;l++){const p=["empty","forest","mountain","water","spiritVein","monster","exit"],k=[.45,.2,.15,.1,.04,.04,.02],N=Math.random();let s=0,y="empty";for(let v=0;v<p.length;v++){const M=k[v];if(s+=M,N<s){const B=p[v];B!==void 0&&(y=B);break}}o.push(y)}e.push(o)}return e},V=()=>{for(let t=0;t<g.value.length;t++){const o=g.value[t];if(o!==void 0)for(let l=0;l<o.length;l++)o[l]==="player"&&(o[l]="empty")}const{x:n,y:e}=i.value;if(n>=0&&n<100&&e>=0&&e<100){const t=g.value[e];t!==void 0&&(t[n]="player")}},j=m(["gold","wood","water","fire","earth"]),G=m({gold:"é‡‘",wood:"æœ¨",water:"æ°´",fire:"ç«",earth:"åœŸ"}),H=m({gold:"#ffd700",wood:"#90ee90",water:"#87ceeb",fire:"#ff6347",earth:"#deb887"}),I=m([{color:"#e6f7ff",text:"æ™®é€šåœ°å½¢",icon:""},{color:"#95de64",text:"æ£®æž—",icon:""},{color:"#ffd591",text:"å±±è„‰",icon:""},{color:"#bae7ff",text:"æ°´åŸŸ",icon:""},{color:"#73d13d",text:"çµè„‰",icon:"ðŸ’Ž"},{color:"#ff7875",text:"æ€ªç‰©",icon:"ðŸ‘¹"},{color:"#c9c9c9",text:"å‡ºå£",icon:"ðŸšª"},{color:"transparent",text:"çŽ©å®¶",icon:"ðŸ‘¤"}]),U=n=>({player:"cell-player",spiritVein:"cell-spirit-vein",monster:"cell-monster",exit:"cell-exit",forest:"cell-forest",mountain:"cell-mountain",water:"cell-water"})[n]||"cell-empty",W=n=>({forest:{backgroundColor:"#95de64"},mountain:{backgroundColor:"#ffd591"},water:{backgroundColor:"#bae7ff"},spiritVein:{backgroundColor:"#73d13d"},monster:{backgroundColor:"#ff7875"},exit:{backgroundColor:"#c9c9c9"},player:{backgroundColor:"#e6f7ff"}})[n]||{backgroundColor:"#e6f7ff"},X=(n,e,t,o)=>{const l=[];let p=n,k=e;for(;p!==t;)p+=p<t?1:-1,l.push({x:p,y:k});for(;k!==o;)k+=k<o?1:-1,l.push({x:p,y:k});return l},Y=async(n,e)=>{if(!(w.value||i.value.x===n&&i.value.y===e)){w.value=!0;try{const t=X(i.value.x,i.value.y,n,e);for(const o of t)i.value={x:o.x,y:o.y},c.player&&(c.player.currentLocation={...c.player.currentLocation,x:o.x,y:o.y,name:T(o.x,o.y)}),V(),console.log(`ç§»åŠ¨åˆ°åæ ‡ (${o.x}, ${o.y})`),P(),await new Promise(l=>setTimeout(l,E))}catch(t){console.error("ç§»åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:",t)}finally{w.value=!1}}},P=()=>{if(C.value){const e=i.value.x*48,t=i.value.y*48;C.value.scrollTo({left:e-C.value.clientWidth/2,top:t-C.value.clientHeight/2,behavior:"smooth"})}},T=(n,e)=>{if(g.value[e]&&g.value[e][n])switch(g.value[e][n]){case"forest":return"æ£®æž—åŒºåŸŸ";case"mountain":return"å±±åœ°";case"water":return"æ°´åŸŸ";case"spiritVein":return"çµè„‰æ‰€åœ¨åœ°";case"monster":return"æ€ªç‰©é¢†åœ°";case"exit":return"å‡ºå£";default:return"æ™®é€šåŒºåŸŸ"}return"æœªçŸ¥åŒºåŸŸ"};te(()=>{console.log("æŽ¢ç´¢é¡µé¢åˆå§‹åŒ–"),g.value.length===0&&(g.value=Q()),c.player?.currentLocation&&(i.value.x=c.player.currentLocation.x,i.value.y=c.player.currentLocation.y),V(),c.player&&(c.player.currentLocation={...c.player.currentLocation,x:i.value.x,y:i.value.y,name:T(i.value.x,i.value.y)}),setTimeout(()=>{P()},100)});const $=async n=>{if(!w.value){w.value=!0;try{const{x:e,y:t}=i.value;let o=e,l=t;switch(n){case"up":t>0&&l--;break;case"down":t<99&&l++;break;case"left":e>0&&o--;break;case"right":e<99&&o++;break}(o!==e||l!==t)&&(i.value={x:o,y:l},c.player&&(c.player.currentLocation={...c.player.currentLocation,x:o,y:l,name:T(o,l)}),V(),console.log(`å‘${n}ç§»åŠ¨åˆ°åæ ‡ (${o}, ${l})`),P(),await new Promise(p=>setTimeout(p,E)))}catch(e){console.error("æ–¹å‘ç§»åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:",e)}finally{w.value=!1}}},A=()=>{console.log("è·³è½¬åˆ°ä¿®ç‚¼é¡µé¢"),F.push("/mobile/ä¿®ç‚¼")},J=()=>{S.value=!0},K=m([{label:"ä¿®ç‚¼",type:"primary",handler:A}]);return(n,e)=>{const t=b("a-button"),o=b("a-layout-content"),l=b("a-col"),p=b("a-row"),k=b("a-modal"),N=b("a-layout");return r(),D(N,{class:"mobile-exploration"},{default:d(()=>[_(o,null,{default:d(()=>[a("div",se,[a("div",ne,[a("div",re,x(f.value.name),1),a("div",ie,"åæ ‡: "+x(f.value.x)+", "+x(f.value.y),1)]),a("div",ce,[_(t,{type:"text",size:"small",onClick:J},{default:d(()=>[...e[5]||(e[5]=[h("å›¾ä¾‹",-1)])]),_:1})])]),a("div",ue,[a("div",de,[a("div",{class:"game-map",ref_key:"mapRef",ref:C},[a("div",pe,[(r(!0),u(z,null,L(g.value,(s,y)=>(r(),u("div",{key:`row-${y}`,class:"map-row"},[(r(!0),u(z,null,L(s,(v,M)=>(r(),u("div",{key:`cell-${M}-${y}`,class:oe(["map-cell",U(v)]),onClick:B=>Y(M,y),style:R(W(v))},[v==="player"?(r(),u("span",fe,"ðŸ‘¤")):v==="spiritVein"?(r(),u("span",ye,"ðŸ’Ž")):v==="monster"?(r(),u("span",me,"ðŸ‘¹")):v==="exit"?(r(),u("span",_e,"ðŸšª")):q("",!0)],14,ve))),128))]))),128))])],512),a("div",xe,[a("div",ge,[_(t,{type:"default",size:"small",onClick:e[0]||(e[0]=s=>$("up")),class:"nav-btn"},{default:d(()=>[...e[6]||(e[6]=[h("â†‘",-1)])]),_:1})]),a("div",ke,[_(t,{type:"default",size:"small",onClick:e[1]||(e[1]=s=>$("left")),class:"nav-btn"},{default:d(()=>[...e[7]||(e[7]=[h("â†",-1)])]),_:1}),_(t,{type:"default",size:"small",onClick:e[2]||(e[2]=s=>$("down")),class:"nav-btn"},{default:d(()=>[...e[8]||(e[8]=[h("â†“",-1)])]),_:1}),_(t,{type:"default",size:"small",onClick:e[3]||(e[3]=s=>$("right")),class:"nav-btn"},{default:d(()=>[...e[9]||(e[9]=[h("â†’",-1)])]),_:1})])])])]),a("div",we,[e[13]||(e[13]=a("div",{class:"section-title"},"å½“å‰åœ°ç‚¹",-1)),a("div",be,[f.value.spiritVein?(r(),u("div",he,[e[10]||(e[10]=a("div",{class:"detail-label"},"çµè„‰:",-1)),a("div",Ce,x(f.value.spiritVein.name)+" ("+x(f.value.spiritVein.level)+"çº§)",1)])):q("",!0),f.value.monster?(r(),u("div",Le,[e[11]||(e[11]=a("div",{class:"detail-label"},"æ€ªç‰©:",-1)),a("div",ze,x(f.value.monster.name)+" ("+x(f.value.monster.level)+"çº§)",1)])):q("",!0),a("div",$e,[e[12]||(e[12]=a("div",{class:"detail-label"},"çµæ°”:",-1)),a("div",Me,[(r(!0),u(z,null,L(j.value,s=>(r(),u("div",{key:s,class:"spirit-qi-dot",style:R({backgroundColor:H.value[s]}),title:`${G.value[s]}: ${f.value.spiritQi[s]}`},null,12,Se))),128))])])])]),a("div",Ve,[e[14]||(e[14]=a("div",{class:"section-title"},"æ“ä½œ",-1)),a("div",Pe,[(r(!0),u(z,null,L(K.value,(s,y)=>(r(),D(t,{key:y,type:s.type,size:"small",onClick:s.handler,class:"action-btn"},{default:d(()=>[h(x(s.label),1)]),_:2},1032,["type","onClick"]))),128))])])]),_:1}),_(k,{open:S.value,"onUpdate:open":e[4]||(e[4]=s=>S.value=s),title:"åœ°å›¾å›¾ä¾‹",size:"small",footer:"null"},{default:d(()=>[a("div",Te,[(r(!0),u(z,null,L(I.value,(s,y)=>(r(),D(p,{gutter:[8,8],key:y},{default:d(()=>[_(l,{span:6},{default:d(()=>[a("div",{class:"legend-color",style:R({backgroundColor:s.color})},null,4)]),_:2},1024),_(l,{span:12},{default:d(()=>[a("span",Ne,x(s.text),1)]),_:2},1024),_(l,{span:6},{default:d(()=>[a("span",Be,x(s.icon),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1},8,["open"])]),_:1})}}}),Ee=le(De,[["__scopeId","data-v-197dc0c5"]]);export{Ee as default};
